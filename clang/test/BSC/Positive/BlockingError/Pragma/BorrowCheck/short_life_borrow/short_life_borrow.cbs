// RUN: %clang -rewrite-bsc %s -o %t-rw.c
// RUN: FileCheck --input-file=%t-rw.c %s
// expected-no-diagnostics

void use_mut(int *borrow p);
void test1(int *borrow p) {
  {
    int local1 = 42;
    #pragma GCC diagnostic push
    #pragma GCC diagnostic ignored "-Eshort-life-borrow"
    p = &mut local1; // `local1` does not live long enough
    #pragma GCC diagnostic pop
  }
  use_mut(p);
}

// CHECK:      void use_mut(int * p);
// CHECK-EMPTY: 
// CHECK:      void test1(int * p) {
// CHECK-NEXT:     {
// CHECK-NEXT:         int local1 = 42;
// CHECK-NEXT:         p = &local1;
// CHECK-NEXT:     }
// CHECK-NEXT:     use_mut(p);
// CHECK-NEXT: }
