// RUN: %clang -rewrite-bsc %s -o %t-rw.c
// RUN: FileCheck --input-file=%t-rw.c %s
// expected-no-diagnostics

void test1() {
  int local = 42;
  int *borrow p = &mut local;
  int *borrow q = p;
  p = q;
  #pragma GCC diagnostic push
  #pragma GCC diagnostic ignored "-Euse-mutably-borrowed"
  int temp = *q;  // cannot use `*q` because it was mutably borrowed
  #pragma GCC diagnostic pop
}

// CHECK:      void test1(void) {
// CHECK-NEXT:     int local = 42;
// CHECK-NEXT:     int * p = &local;
// CHECK-NEXT:     int * q = p;
// CHECK-NEXT:     p = q;
// CHECK-NEXT:     int temp = *q;
// CHECK-NEXT: }
