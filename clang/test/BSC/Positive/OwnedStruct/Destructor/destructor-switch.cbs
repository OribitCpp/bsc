// RUN: %clang %s -o %test.output
// RUN: %test.output
// RUN: %clang -rewrite-bsc %s -o %t-rw.c
// RUN: %clang %t-rw.c -o %t-rw.output
// RUN: %t-rw.output
int y = 0;
owned struct S {
public:
  ~S(S this) {
    y++;
  }
};

int foo1() {
  switch (1) {
  case 1:
    ;
   { S s = {}; }
     _Bool x = 1;
    if(x) { S s = {}; }
   break;
  default:
    break;
  }
  return 0;
}

int foo2() {
  switch (2) {
  case 1:
  default:{
    { S s = {}; }
    _Bool x = 1;
    if(x) { S s = {}; }
    break;
    }
  }
  return 0;
}

int Goo1<T>() {
  switch (1) {
  case 1:
    ;
   { S s = {}; }
     _Bool x = 1;
    if(x) { S s = {}; }
   break;
  default:
    break;
  }
  return 0;
}

int Goo2<T>() {
  switch (2) {
  case 1:
  default:{
    { S s = {}; }
    _Bool x = 1;
    if(x) { S s = {}; }
    break;
    }
  }
  return 0;
}


int main() { 
  foo1();
  foo2();
  Goo1<S>();
  Goo2<S>();
  return y-8;
}