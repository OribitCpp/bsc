// RUN: %clang %s -o %t.output
// RUN: %t.output
// RUN: %clang -rewrite-bsc %s -o %t-rw.c
// RUN: FileCheck --input-file=%t-rw.c %s
// RUN: %clang %t-rw.c -o %t-rw.output
// RUN: %t-rw.output
// expected-no-diagnostics

trait F {
  int foo(const This* this);
  int goo(owned This* this);
  int hoo(const owned This* this);
  int ioo(This* const owned this);
  int joo(const This* const this);
  int koo(owned This* owned this);
  int loo(owned This* const this);
  int moo(const This* owned this);
};

int int::foo(const int* this) {
  return 1;
}

int int::goo(owned int* this) {
  return 1;
}

int int::hoo(const owned int* this) {
  return 1;
}

int int::ioo(int* const owned this) {
  int *p = (int *)this;
  return 1;
}

int int::joo(const int* const this) {
  return 1;
}

int int::koo(owned int* owned this) {
  int *p = (int *)this;
  return 1;
}

int int::loo(owned int* const this) {
  return 1;
}

int int::moo(const int* owned this) {
  int *p = (int *)this;
  return 1;
}

impl trait F for int;

int main(){
  return 0;
}

// CHECK: struct __Trait_F_Vtable {
// CHECK-NEXT: int (*foo)(const void *);
// CHECK-NEXT: int (*goo)( void *);
// CHECK-NEXT: int (*hoo)(const void *);
// CHECK-NEXT: int (*ioo)(void *);
// CHECK-NEXT: int (*joo)(const void *);
// CHECK-NEXT: int (*koo)( void *);
// CHECK-NEXT: int (*loo)( void *);
// CHECK-NEXT: int (*moo)(const void *);
// CHECK-NEXT: };

// CHECK: struct __Trait_F {
// CHECK-NEXT: void *data;
// CHECK-NEXT: struct __Trait_F_Vtable *vtable;
// CHECK-NEXT: };

// CHECK: int int_foo(const int *this) {
// CHECK-NEXT: return 1;
// CHECK-NEXT: }

// CHECK: int int_goo( int *this) {
// CHECK-NEXT: return 1;
// CHECK-NEXT: }

// CHECK: int int_hoo(const int *this) {
// CHECK-NEXT: return 1;
// CHECK-NEXT: }

// CHECK: int int_ioo(int *const this) {
// CHECK-NEXT: int *p = (int *)this;
// CHECK-NEXT: return 1;
// CHECK-NEXT: }

// CHECK: int int_joo(const int *const this) {
// CHECK-NEXT: return 1;
// CHECK-NEXT: }

// CHECK: int int_koo( int * this) {
// CHECK-NEXT: int *p = (int *)this;
// CHECK-NEXT: return 1;
// CHECK-NEXT: }

// CHECK: int int_loo( int *const this) {
// CHECK-NEXT: return 1;
// CHECK-NEXT: }

// CHECK: int int_moo(const int * this) {
// CHECK-NEXT: int *p = (int *)this;
// CHECK-NEXT: return 1;
// CHECK-NEXT: }

// CHECK: struct __Trait_F_Vtable __int_trait_F = {.foo = (int (*)(const void *))int_foo, .goo = (int (*)( void *))int_goo, .hoo = (int (*)(const void *))int_hoo, .ioo = (int (*)(void *))int_ioo, .joo = (int (*)(const void *))int_joo, .koo = (int (*)( void *))int_koo, .loo = (int (*)( void *))int_loo, .moo = (int (*)(const void *))int_moo};

// CHECK: int main(){
// CHECK-NEXT:  return 0;
// CHECK-NEXT: }