// RUN: %clang %s -o %t.output
// RUN: %t.output
// expected-no-diagnostics

#include <stdio.h>
trait M{
    void f(This* this, int b);
    void dump(This* this);
};

typedef struct S {
    int a;
}S1;
void S1::f(This* this, int b) {
    this->a = this->a + b;
}
void struct S::dump(This* this) {
    printf("%d\n", this->a);
}

void int::f(This* this, int b) {
    *this = *this + b;
}
void int::dump(This* this) {
    printf("%d\n", *this);
}

impl trait M for int;
impl trait M for S1;

void foo(trait M* t) {
    t->f(4);
    t->dump();
}

int main() {
    struct S s = {.a = 5};
    foo(&s);  // print 9
    int c = 10;
    foo(&c);  // print 14
    
    return 0;
}
