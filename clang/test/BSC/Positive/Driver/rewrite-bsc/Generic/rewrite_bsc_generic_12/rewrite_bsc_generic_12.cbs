// RUN: %clang -rewrite-bsc %s -o %t-rw.c
// RUN: FileCheck --input-file=%t-rw.c %s
// RUN: %clang %t-rw.c -o %t-rw.output
// RUN: %t-rw.output

struct A<T> {
    T value;
};

struct B {
    struct A<int> a;
};

struct C {
    struct A<int>* a;
};

typedef struct D {
    struct A<int>* a;
}D;

typedef struct {
    struct A<int>* a;
}E;

// global var
struct A<int> a;

struct A<int>* b;

struct A<int>* (c)();

typedef struct A<int>* (d)();

// as param
int case0(struct A<int> a) {
    return 0;
}

int case1(struct A<int>* a) {
    return 0;
}

// as return type
struct A<int>* case2() {
    return 0;
}

// as local var
int case3() {
    struct A<int> a;
    return 0;
};

int case4() {
    struct A<int>* a;
    return 0;
};

int case5() {
    int* a = 0;
    (struct A<int>*)a;
    return 0;
}

int case6() {
    int* a = 0;
    int b = ((struct A<int>*)a)->value + 0;
    return 0;
}

int main() { return 0; }


// CHECK:      typedef struct D D;
// CHECK-EMPTY:
// CHECK-NEXT: typedef struct _TD_E E;
// CHECK-EMPTY:
// CHECK-NEXT: typedef struct A_int *(d)(void);
// CHECK-EMPTY:
// CHECK-NEXT: struct A_int {
// CHECK-NEXT:   int value;
// CHECK-NEXT: };
// CHECK-EMPTY:
// CHECK-NEXT: struct C {
// CHECK-NEXT:   struct A_int *a;
// CHECK-NEXT: };
// CHECK-EMPTY:
// CHECK-NEXT: struct D {
// CHECK-NEXT:   struct A_int *a;
// CHECK-NEXT: };
// CHECK-EMPTY:
// CHECK-NEXT: struct _TD_E {
// CHECK-NEXT:   struct A_int *a;
// CHECK-NEXT: };
// CHECK-EMPTY:
// CHECK-NEXT: struct B {
// CHECK-NEXT:   struct A_int a;
// CHECK-NEXT: };
// CHECK-EMPTY:
// CHECK-NEXT: struct A_int a;
// CHECK-EMPTY:
// CHECK-NEXT: struct A_int *b;
// CHECK-EMPTY:
// CHECK-NEXT: struct A_int *(c)(void);
// CHECK-EMPTY:
// CHECK-NEXT: int case0(struct A_int a) {
// CHECK-NEXT:     return 0;
// CHECK-NEXT: }
// CHECK-EMPTY:
// CHECK-NEXT: int case1(struct A_int *a) {
// CHECK-NEXT:     return 0;
// CHECK-NEXT: }
// CHECK-EMPTY:
// CHECK-NEXT: struct A_int *case2(void) {
// CHECK-NEXT:     return 0;
// CHECK-NEXT: }
// CHECK-EMPTY:
// CHECK-NEXT: int case3(void) {
// CHECK-NEXT:     struct A_int a;
// CHECK-NEXT:     return 0;
// CHECK-NEXT: }
// CHECK-EMPTY:
// CHECK-NEXT: int case4(void) {
// CHECK-NEXT:     struct A_int *a;
// CHECK-NEXT:     return 0;
// CHECK-NEXT: }
// CHECK-EMPTY:
// CHECK-NEXT: int case5(void) {
// CHECK-NEXT:     int *a = 0;
// CHECK-NEXT:     (struct A_int *)a;
// CHECK-NEXT:     return 0;
// CHECK-NEXT: }
// CHECK-EMPTY:
// CHECK-NEXT: int case6(void) {
// CHECK-NEXT:     int *a = 0;
// CHECK-NEXT:     int b = ((struct A_int *)a)->value + 0;
// CHECK-NEXT:     return 0;
// CHECK-NEXT: }
// CHECK-EMPTY:
// CHECK-NEXT: int main() { return 0; }
