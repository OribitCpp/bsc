// RUN: %clang -rewrite-bsc %s -o %t-rw.c
// RUN: FileCheck --input-file=%t-rw.c %s
// RUN: %clang %t-rw.c -o %t-rw.output
// RUN: %t-rw.output

typedef MyLongInt = long int;
typedef MyType<T> = T;

struct G {
    MyLongInt a;
    MyType<int> b;
};

struct S<T> {
    MyLongInt a;
    MyType<int> b;
    MyType<T> c;
};

void foo1() {
    MyLongInt a;
    MyType<int> b;
    typedef MyLongInt1 = long int;
    MyLongInt1 c;
}

void foo2<T>() {
    MyLongInt a;
    MyType<int> b;
    MyType<T> c;
    typedef MyLongInt1 = long int;
    typedef MyType1 = T;
    MyLongInt1 d;
    MyType1 e;
}

void foo3() {
    typedef MyLongInt1 = long int;
}

void foo4<T>() {
    typedef MyLongInt1 = long int;
    typedef MyType1 = T;
}

int main() {
    MyLongInt a = 5;
    MyType<int> b = 5;
    struct G g;
    struct S<int> s;
    foo1();
    foo2<int>();
    foo3();
    foo4<int>();
    return 0;
}

// CHECK: struct G {
// CHECK-NEXT:     MyLongInt a;
// CHECK-NEXT:     int b;
// CHECK-NEXT: };
// CHECK-EMPTY:
// CHECK-NEXT: struct S_int {
// CHECK-NEXT:     MyLongInt a;
// CHECK-NEXT:     int b;
// CHECK-NEXT:     int c;
// CHECK-NEXT: };
// CHECK-EMPTY:
// CHECK-NEXT: static void foo2_int(void);
// CHECK-EMPTY:
// CHECK-NEXT: static void foo4_int(void);
// CHECK-EMPTY:
// CHECK-NEXT: void foo1(void) {
// CHECK-NEXT:     MyLongInt a;
// CHECK-NEXT:     int b;
// CHECK-NEXT:     typedef long MyLongInt1;
// CHECK-NEXT:     MyLongInt1 c;
// CHECK-NEXT: }
// CHECK-EMPTY:
// CHECK-NEXT: void foo3(void) {
// CHECK-NEXT:     typedef long MyLongInt1;
// CHECK-NEXT: }
// CHECK-EMPTY:
// CHECK-NEXT: int main(void) {
// CHECK-NEXT:     MyLongInt a = 5;
// CHECK-NEXT:     int b = 5;
// CHECK-NEXT:     struct G g;
// CHECK-NEXT:     struct S_int s;
// CHECK-NEXT:     foo1();
// CHECK-NEXT:     foo2_int();
// CHECK-NEXT:     foo3();
// CHECK-NEXT:     foo4_int();
// CHECK-NEXT:     return 0;
// CHECK-NEXT: }
// CHECK-EMPTY:
// CHECK-NEXT: static void foo2_int(void) {
// CHECK-NEXT:     MyLongInt a;
// CHECK-NEXT:     int b;
// CHECK-NEXT:     int c;
// CHECK-NEXT:     typedef long MyLongInt1;
// CHECK-NEXT:     typedef int MyType1;
// CHECK-NEXT:     MyLongInt1 d;
// CHECK-NEXT:     MyType1 e;
// CHECK-NEXT: }
// CHECK-EMPTY:
// CHECK-NEXT: static void foo4_int(void) {
// CHECK-NEXT:     typedef long MyLongInt1;
// CHECK-NEXT:     typedef int MyType1;
// CHECK-NEXT: }